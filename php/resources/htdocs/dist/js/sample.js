"use strict";(()=>{var e={MODULE:"data-module",PAGE:"data-page",SCOPE:"data-scope",ACTION:"data-action",FEATURE:"data-feature"},t="is_active",n=new Set(["focus","blur","mouseenter","mouseleave","pointerenter","pointerleave","load","error","abort","resize","scroll","DOMContentLoaded","readystatechange","unload","beforeunload","pagehide","visibilitychange"]),o=new Set(["mousemove","pointermove","touchmove","wheel","drag","dragover","drop","input","keydown","keyup"]),r=e=>{if(e===document)return"document";if(e instanceof Element){const t=e.id?`#${e.id}`:"";return`<${e.tagName.toLowerCase()}${t}>`}return String(e)},a=(e,t,n)=>{const o=r(t);console.warn(`[delegate警告] ${n}\n  event="${e}" / root=${o}\n  → 委譲設計の見直しを推奨します。`)},i=/^[^.]+\.[^.]+$/,s=(t,s,c,d={})=>{const l="string"==typeof d?{eventType:d}:d,{eventType:u="click",selector:m=`[${e.ACTION}]`,getKey:f=t=>t.getAttribute(e.ACTION),suppressWarn:g=!1,force:h=!1}=l;if(t){if(!g)if(n.has(u)){if(a(u,t,"委譲不可イベントです（バブリングしない/扱いが特殊）"),!h)return}else o.has(u)&&a(u,t,"委譲は非推奨です（高頻度/重い可能性）");t.addEventListener(u,e=>{const n=e.target instanceof Element?e.target:null;if(!n)return;const o=n.closest(m);if(!o)return;if(t instanceof Element&&!t.contains(o))return;const a=f(o);!a||g||i.test(a)||((e,t)=>{const n=r(t);console.warn(`[delegate警告] data-action は「prefix.actionName」形式で指定してください（例: page.xxx, modal.xxx）。\n  現在の値: "${e}" / root=${n}`)})(a,t);const s=c[a];s&&s(e,o)},{signal:s.signal})}},c="is-scroll-locked",d=(e=!0,t)=>{const n=window.innerWidth-document.documentElement.clientWidth;e&&(document.documentElement.style.setProperty("--scrollbar-width",`${n}px`),document.body.style.width=`${document.documentElement.clientWidth}px`),document.body.style.overflow="hidden",document.body.classList.add(c),t&&t.addEventListener("abort",()=>{e&&(document.body.style.width=""),document.body.style.overflow="visible",document.body.classList.remove(c)},{once:!0})},l=(e=!0,t)=>{e&&(document.body.style.width=""),document.body.style.overflow="visible",document.body.classList.remove(c)},u='a[href], button:not([disabled]), textarea:not([disabled]), input:not([disabled]), select:not([disabled]), [tabindex]:not([tabindex="-1"])',m=(e,t={})=>{const{selector:n=u,filterVisible:o=!0}=t,r=e.querySelectorAll(n);return o?Array.from(r).filter(e=>{if(e.hasAttribute("disabled"))return!1;const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"collapse"!==t.visibility}):Array.from(r)},f=(e,t,n={})=>{if("Tab"!==t.key)return!1;const o=m(e,n);if(0===o.length)return!1;const r=document.activeElement,a=o[0],i=o[o.length-1];if(t.shiftKey){if(r===a)return t.preventDefault(),i.focus(),!0}else if(r===i)return t.preventDefault(),a.focus(),!0;return!1},g=e=>{e instanceof HTMLElement&&document.contains(e)&&e.focus()},h=(e,t={})=>{const{trigger:n,fallbackSelector:o}=t;n instanceof HTMLElement&&document.activeElement===n&&n.blur(),requestAnimationFrame(()=>((e,t={})=>{const{fallbackSelector:n,selector:o}=t,r=m(e,{selector:o})[0];if(r)r.focus();else if(n){const t=e.querySelector(n);t instanceof HTMLElement&&(t.hasAttribute("tabindex")||t.setAttribute("tabindex","-1"),t.focus())}})(e,{fallbackSelector:o}))},v=`[${e.MODULE}="header"]`,b="[data-header-menu]",p=null,y=()=>document.querySelector(v),E=()=>y()?.classList.contains(t)??!1,w=()=>{const e=y();if(!e)return;const n=e.querySelector("[data-header-btn]"),o=e.querySelector(b),r=e.querySelector("[data-header-bg]");n&&o&&r&&(p=document.activeElement instanceof HTMLElement?document.activeElement:null,e.classList.add(t),e.setAttribute("aria-expanded","true"),d(!0,void 0),h(e,{trigger:p,fallbackSelector:b}))},L=()=>{const e=y();e&&(e.classList.remove(t),e.setAttribute("aria-expanded","false"),l(!0),g(p),p=null)},A=({scope:e})=>{const t=y();t&&(t.setAttribute("aria-expanded","false"),s(t,e,{"header.toggle":()=>{E()?L():w()},"header.close":L}),document.addEventListener("keydown",e=>{"Escape"===e.key&&E()&&L(),"Tab"===e.key&&E()&&f(t,e)},{signal:e.signal}))},S="theme-mode";function $(){try{return localStorage.getItem(S)}catch(e){return console.warn("ローカルストレージへのアクセスに失敗しました。",e),null}}function q(e){e||(e="default"),document.documentElement.setAttribute("data-theme",e)}function k(e=!0){let t="default";if(e){const e=$();e&&(t=e)}return e&&$()||(t=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"default"),q(t),t}var T="data-themeToggle-theme",x="data-theme",M=(e.MODULE,S),D=(e,t=!0)=>{if(e||(e="default"),document.documentElement.setAttribute(x,e),t)try{localStorage.setItem(M,e)}catch(e){console.warn("ローカルストレージへの保存に失敗しました。",e)}document.dispatchEvent(new CustomEvent("themechange",{detail:{theme:e}}))},C=({scope:e})=>{s(document,e,{"themeToggle.toggle":(e,t)=>{const n=t.getAttribute(T);n?D(n,!0):console.warn(`${T}属性が設定されていません。`,t)}})};function O(e){const t=document.querySelectorAll('a[href^="#"]');t&&0!==t.length&&t.forEach(t=>{t.addEventListener("click",t=>function(e,t){const n=e.currentTarget.getAttribute("href");if(!n||"#"===n||"#0"===n)return;const o=n.split("#")[1];if(!o)return;const r=document.getElementById(o)||document.querySelector(n);if(!r)return void console.warn(`ターゲット要素 "#${o}" が見つかりません。`);e.preventDefault(),function(e,t){const n=500,o=0,r=document.querySelector("header"),a=r?r.offsetHeight:0,i=e.getBoundingClientRect(),s=window.getComputedStyle(e),c=parseFloat(s.getPropertyValue("padding-block-start")),d=window.scrollY;!function(e,t,n){const o=window.scrollY,r=e-o;let a=null,i=null;function s(e){if(n?.aborted)return;null===a&&(a=e);const c=e-a,d=Math.min(c/t,1),l=d<.5?4*d*d*d:1-Math.pow(-2*d+2,3)/2;window.scrollTo(0,o+r*l),c<t&&(i=requestAnimationFrame(s))}i=requestAnimationFrame(s),n&&n.addEventListener("abort",()=>{null!==i&&cancelAnimationFrame(i)},{once:!0})}(d+i.top+c-a+o,n,t)}(r,t)}(t,e),{signal:e})})}async function H(e){const t=e.scope??{signal:e.signal},n=t.signal;k(),C({scope:t}),function(e,t=!0){const n=window.matchMedia("(prefers-color-scheme: dark)"),o=e=>{if(t&&!$()){const t=e.matches?"dark":"default";q(t);const n=new CustomEvent("themechange",{detail:{theme:t}});document.dispatchEvent(n)}};n.addEventListener?n.addEventListener("change",o,{signal:e}):(n.addListener(o),e.addEventListener("abort",()=>{n.removeListener(o)}))}(n),O(n),A({scope:t}),document.body.classList.remove("is_nojs"),document.querySelectorAll("img").forEach(e=>{e.addEventListener("contextmenu",e=>e.preventDefault(),{signal:n}),e.addEventListener("selectstart",e=>e.preventDefault(),{signal:n}),e.addEventListener("mousedown",e=>e.preventDefault(),{signal:n})});const o=document.querySelector("main"),r=document.querySelector("footer");if(o&&r){const e=()=>{const e=window.innerHeight,t=r.offsetHeight;o.style.minHeight=e-t+"px"};e(),window.addEventListener("resize",e,{signal:n})}}var F="modal",U="data-modal-id",P=null,I=()=>document.querySelector(`[${e.MODULE}="${F}"].${t}`),N=!1,R=(n={})=>{N||(N=!0,document.addEventListener("keydown",e=>{if("Escape"===e.key)return void W();if("Tab"!==e.key)return;const t=I();t&&f(t,e)}));const o=(t=>{if(t){const n=document.querySelector(`[${e.MODULE}="${F}"][${U}="${t}"]`);if(n)return n}return document.querySelector(`[${e.MODULE}="${F}"]`)})(n.id??n.trigger?.getAttribute(U));o&&(P=n.trigger instanceof HTMLElement?n.trigger:document.activeElement,o.hidden=!1,o.setAttribute("aria-hidden","false"),requestAnimationFrame(()=>{requestAnimationFrame(()=>{o.classList.add(t),h(o,{trigger:P,fallbackSelector:"[data-modal-dialog]"})})}),d(!0,void 0))},W=()=>{const e=I();if(!e)return void l(!0);const n=e.querySelectorAll("[data-modal-scroll]");n.length>0&&n.forEach(e=>{e.scrollTop=0}),e.classList.remove(t),l(!0);let o=!1;const r=P,a=()=>{o||(o=!0,e.removeEventListener("transitionend",a),e.hidden=!0,e.setAttribute("aria-hidden","true"),g(r),P=null)};e.addEventListener("transitionend",a,{once:!0}),setTimeout(()=>a(),450)},z=({scope:e})=>{s(document,e,{"modal.open":(e,t)=>{R({trigger:t,id:t.getAttribute(U)})},"modal.close":()=>{W()}})},B=`[${e.MODULE}="accordion"]`,K=({scope:e,root:n=document})=>{n.querySelectorAll(B).forEach(n=>{s(n,e,{"accordion.toggle":(e,o)=>{e.target.closest("a")||n.classList.toggle(t)}})})};(async(e,t={})=>{await("loading"===document.readyState?new Promise(e=>{document.addEventListener("DOMContentLoaded",e,{once:!0})}):Promise.resolve());const n=e({...t,document:document,window:window})||(()=>{});window.addEventListener("pagehide",()=>n(),{once:!0})})((({getRoot:e,init:t})=>(n={})=>{const o=n.root??e?.(n);if(!o)return()=>{};const r=(e=>{const t=new AbortController;return e&&(e.aborted?t.abort():e.addEventListener("abort",()=>t.abort(),{once:!0})),{signal:t.signal,onDispose:e=>{t.signal.addEventListener("abort",e,{once:!0})},dispose:()=>t.abort()}})();return H({...n,root:o,scope:r}),t?.({...n,root:o,scope:r}),()=>r.dispose()})({getRoot:()=>document.querySelector(`[${e.SCOPE}="home"]`)||document.querySelector("#top"),init:({root:e,scope:t})=>{z({scope:t}),K({root:e,scope:t}),s(e,t,{"page.sampleClick":(e,t)=>{e.preventDefault(),console.log("サンプルボタンがクリックされました",t),t.dataset.message&&console.log(t.dataset.message)}})}}))})();