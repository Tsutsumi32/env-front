@use 'sass:meta';
@use 'sass:map';
@use 'sass:list';
/******************************************************************
* 変数・取得設定
* ※mapなども定義されていますが、各実装の場面では、フラットな変数を使用します
* Mapの取得用functionがある場合は、該当のfunctionを使用して値を設定します。
* (スニペット使用推奨)
*******************************************************************/
/* base font size
----------------------------------------------------------------- */
// ベースフォントサイズ(htmlサイズ)
// vwやremの計算に使用する
$font-s_base: 16px;

/* size
----------------------------------------------------------------- */
// デザインサイズ
//////////////////////////////////////////////
$design_size_sp: 375;
$design_size_pc: 1600;

// デザインのコンテナ
//////////////////////////////////////////////
// SPデザインのコンテナサイズ
$design_container_sp: 343;
// PCデザインのコンテナサイズ
$design_container_pc: 1131;

// スクロールバー幅バッファ
//////////////////////////////////////////////
$width_scrollbar: 20;

// pc時の左右余白最低値
//////////////////////////////////////////////
$padding_container_pc: 20;

// PC時に最低限確保する幅
// pcデザインコンテナ(確保したい幅) + 確保したい左右余白 + スクロールバーバッファ)
//////////////////////////////////////////////
$minWidth_container_pc: calc($design_container_pc + $padding_container_pc + $width_scrollbar);

// レスポンシブ(rem)対応時のSPの最小幅
// これ以下はリキッドになるように_style-settings-varsで設定
//////////////////////////////////////////////
$min_layout_width: $design_size_sp;

/* breakpoint
----------------------------------------------------------------- */
// メディアクエリの設計方針
//////////////////////////////////////////////
// 'sp-first': SPファースト（小さい画面から大きい画面へ上書き）
// 'pc-first': PCファースト（大きい画面から小さい画面へ上書き）
$media_query_strategy: 'sp-first' !default;

// ブレイクポイントのキー名一覧マップ（一元管理）
// 構造: $breakpoint-keys: (key: value)
// 実装の際は get-breakpoint-key() を使用して値を取得
$breakpoint-keys: (
  'tab': 'tab',
  'tabL': 'tabL',
  'pc': 'pc',
  'pcL': 'pcL',
  'pcLL': 'pcLL',
) !default;

// get-breakpoint-key ブレイクポイントのキー名を取得する
// @param $key ブレイクポイントキーのキー名
// @return ブレイクポイントのキー名（文字列）
//  例) get-breakpoint-key('tab') → 'tab'
@function get-breakpoint-key($_key) {
  $_value: map.get($breakpoint-keys, $_key);

  @if $_value ==null {
    @error "Breakpoint key '#{$_key}' not found in $breakpoint-keys.";
  }

  @return $_value;
}

// ブレイクポイントのマップ（文字列キー）
// sp-firstとpc-firstで、文字列キーを変更することで柔軟に対応可能
//
// sp-firstの場合の例（小さい順）:
//   'tab': 560,
//   'tabL': 768,
//   'pc': 1120,
//   'pcL': 1400,
//   'pcLL': 1920
//
// pc-firstの場合の例（大きい順）:
//   'pcS': 1920,
//   'pcSS': 1400,
//   'tab': 1120,
//   'tabS': 768,
//   'sp': 560
// 注意: ★sp-firstとpc-firstで、この値自体を手動で書き換える必要があります。
//       必ずsp-first、pc-firstで順番(小さい順・大きい順)を変えることが必要です。
$breakpoints: (
  get-breakpoint-key('tab'): 580,
  get-breakpoint-key('tabL'): 768,
  get-breakpoint-key('pc'): 1080,
  get-breakpoint-key('pcL'): $minWidth_container_pc,
  get-breakpoint-key('pcLL'): 1600,
) !default;

// get-breakpoint ブレイクポイントの値を取得する
// @param $key ブレイクポイントのキー名
// @return ブレイクポイントの値（数値）
//  例) get-breakpoint('tab') → 580
@function get-breakpoint($_key) {
  $_value: map.get($breakpoints, $_key);

  @if $_value ==null {
    @error "Breakpoint key '#{$_key}' not found in $breakpoints.";
  }

  @return $_value;
}

/* style
----------------------------------------------------------------- */
// レスポンシブ・リキッドの設定
// 値の設定は_style-settings.scssの「s()」fucntionを使用します。
// s()を使用することで、本設定に基づいてレスポンシブ・リキッドの対応が設定されます
// (style-settings-vars.scssのmixinで、CSS変数を生成し、計算に使用します。)
//
// 'type': 'liquid' | 'responsive' | 'fixed' | 'none'
//   - 'liquid': vwで計算（リキッド）
//   - 'responsive': remで計算（レスポンシブ(rem値を使用、$min_layout_width以下はvw)）
//   - 'fixed': 前時点のリキッドの変化において、指定時点でのサイズに固定化（vw-to-pixelを使用）
//   - 'none': 変更しない（前のブレイクポイントの値を継承）
// 'base-size': 計算値の倍率を設定(基本は1 s(20) => 1:20px  2:40px)
// 'viewport-base': vwの計算基準となる画面幅（リキッドまたはfixedの場合に使用）
// 'fixed-width': 固定化する時点の画面幅（px、fixedの場合のみ使用）
// 最初のキーは'default'とし、sp-first/pc-firstのどちらでも、メディアクエリを使用しない範囲の指定を行う
// default以降は、$breakpointsのキー名で各ブレイクポイントでの設定を行う
$style-settings: (
  'default': (
    'type': 'liquid',
    'base-size': 1,
    'viewport-base': $design_size_sp,
  ),
  // get-breakpoint-key('tab'): (
  //     'type': 'fixed',
  //     'base-size': 1,
  //     // SPのリキッド基準点
  //     'viewport-base': $design_size_sp,
  //     // TABの時点で固定化
  //     'fixed-width': get-breakpoint('tab'),
  //   ),
  get-breakpoint-key('tab'): (
      'type': 'responsive',
      'base-size': 1,
    ),
  get-breakpoint-key('tabL'): (
    'type': 'none',
  ),
  get-breakpoint-key('pc'): (
    'type': 'none',
  ),
  get-breakpoint-key('pcL'): (
    'type': 'none',
  ),
  get-breakpoint-key('pcLL'): (
    'type': 'liquid',
    'base-size': 1,
    'viewport-base': get-breakpoint('pcLL'),
  ),
);

/* section
----------------------------------------------------------------- */
// セクションサイズの定義
// キー: サイズ名（ly_sectionの モディファイアクラス名として使用）
// 値:
//   - 'default': メディアクエリを使用しない時のデフォルト値（sp-first/pc-first共通）
//   - $breakpointsのキー名 : 該当のメディアクエリで値を設定
// 単位なし => s(数値)
$section-sizes: (
  'small': (
    'default': 50,
    get-breakpoint-key('tab'): 80,
    get-breakpoint-key('pc'): 100,
  ),
  'normal': (
    'default': 80,
    get-breakpoint-key('tab'): 100,
    get-breakpoint-key('pc'): 140,
  ),
  'large': (
    'default': 90,
    get-breakpoint-key('tab'): 110,
    get-breakpoint-key('pc'): 150,
  ),
  'xlarge': (
    'default': 100,
    get-breakpoint-key('tab'): 120,
    get-breakpoint-key('pc'): 160,
  ),
);

/* container
----------------------------------------------------------------- */
// コンテナサイズの定義
// キー: コンテナの種類（ly_container のモディファイアクラス名として使用）
// 値:
//   - 'default': メディアクエリを使用しない時のデフォルト値（sp-first/pc-first共通）
//   - $breakpointsのキー名 : 該当のメディアクエリで値を設定
// 各値は (padding: 余白値, max-width: 最大幅) の形式
// 単位なし => s(数値)　単位あり => 直接指定
// max-widthはオプション（nullの場合は設定しない）
$container-sizes: (
  'normal': (
    'default': (
      'padding': 30,
      'max-width': null,
    ),
    get-breakpoint-key('tab'): (
      'padding': 80,
      'max-width': null,
    ),
    get-breakpoint-key('pc'): (
      'padding': 120,
      'max-width': 1200px,
    ),
  ),
);

/* color
/* _color-themes.scss 「mod()」にて、data-theme属性を元に色を出し分け可能
/* ①-1 モード切り替えあり - 自動色変換
/*     ⇒ ・$colorsにモード毎の色を定義
/*        ・_color-themes.scss generate-color-themes()にて
            data-theme属性毎に、$colorsの色をCSSに設定(globalで呼び出し)
/*        ・get-color(①)で、設定したCSS変数を取得する
/* ①-2 モード切り替えあり - mod()を使用して手動で変換
/*     ⇒ ・上記のCSS生成不要(generate-color-themes()不要)
/*        ・※下記のカラー実装パターン参照
/* ②   モード切り替えなし
/*     ⇒ ・※下記のカラー実装パターン参照
/*
/* <カラー実装パターン>
/* ・役割毎に色が管理されている場合
/*   ⇒ $colorsを使用する(モード切り替えがない場合も、defaultだけの運用)
/* ・役割毎に管理されていない場合
/*   ⇒ $color-paletteを直接参照するget-color(②)を使用する
----------------------------------------------------------------- */

// 色パレットマップ（一元管理）
// プロジェクト全体で使用する色を定義（役割を持たない単純な色名）
// 構造: $color-palette: (name: value)
// 同じ色は1回のみ定義
$color-palette: (
  'black': #000,
  'white': #ffffff,
  'off-white': #fafafa,
  'light-gray': #f2f2f2,
  'gray': #ebebeb,
  'dark-brown': #271a06,
  'brown': #4a4133,
  'medium-brown': #796d57,
  'beige': #e7dfd1,
  'tan': #bcb2a0,
  'yellow': #f6b40a,
  'cream': #f9ebc6,
) !default;

@function get-color-palette($_key) {
  $value: map.get($color-palette, $_key);

  @if $value ==null {
    @error "Color key '#{$key}' not found in $box-shadows.";
  }

  @return $value;
}

// モード別カラーマップ（一元管理）
// 構造: $colors: (mode: (group: (name: value)))
// 例: $colors: (default: (text: (primary: #2B2D31)))
// 注意: 'default'モードは必須。defaultモードは:rootに、その他は[data-theme="モード名"]に出力される
// _color-themes.scssによって、本変数を元に、モード毎のCSS変数を設定
// 下記get-color() functionで、定義されるCSS変数の取得が可能
// ※モード切替自体はJSで制御 JSでユーザー設定や切り替えボタンで data-theme属性の切り替えを行う
$colors: (
  'default': (
    // 基本色
    'base': (
        'black': get-color-palette('black'),
        'white': get-color-palette('light-gray'),
        'accent': get-color-palette('yellow'),
      ),
    // テキスト色
    'text': (
        'primary': get-color-palette('dark-brown'),
        'secondary': get-color-palette('brown'),
        'dark': get-color-palette('black'),
        'link': get-color-palette('dark-brown'),
      ),
    // 背景色
    'bg': (
        'base': get-color-palette('gray'),
        'button': rgba(get-color-palette('beige'), 0.9),
        'tag': rgba(get-color-palette('beige'), 0.15),
        'hover': rgba(get-color-palette('beige'), 0.3),
      ),
    // ボーダー色
    'border': (
        'tag': rgba(get-color-palette('tan'), 0.5),
        'primary': get-color-palette('dark-brown'),
        'light': rgba(get-color-palette('beige'), 0.5),
      ),
    // アクセント色（リンク、ボタンなど）
    'accent': (
        'primary': get-color-palette('yellow'),
        'hover': get-color-palette('cream'),
        'light': get-color-palette('cream'),
      ),
    // UI要素
    'ui': (
        'placeholder': get-color-palette('brown'),
        'highlight': get-color-palette('yellow'),
        'focus-outline': get-color-palette('yellow'),
        'hover': get-color-palette('yellow'),
      ),
    'selection': (
      'selection-text': get-color-palette('dark-brown'),
      'selection-bg': get-color-palette('yellow'),
    ),
  ),
  'dark': (
    // 基本色
    'base': (
        'black': get-color-palette('off-white'),
        'white': get-color-palette('dark-brown'),
        'accent': get-color-palette('yellow'),
      ),
    // テキスト色
    'text': (
        'primary': get-color-palette('off-white'),
        'secondary': rgba(get-color-palette('off-white'), 0.7),
        'dark': get-color-palette('white'),
        'link': get-color-palette('off-white'),
      ),
    // 背景色
    'bg': (
        'base': get-color-palette('dark-brown'),
        'button': rgba(get-color-palette('dark-brown'), 0.95),
        'tag': rgba(get-color-palette('medium-brown'), 0.83),
        'hover': rgba(get-color-palette('brown'), 0.5),
      ),
    // ボーダー色
    'border': (
        'tag': rgba(get-color-palette('tan'), 0.3),
        'primary': rgba(get-color-palette('off-white'), 0.3),
        'light': rgba(get-color-palette('tan'), 0.2),
      ),
    // アクセント色（リンク、ボタンなど）
    'accent': (
        'primary': get-color-palette('yellow'),
        'hover': get-color-palette('cream'),
        'light': get-color-palette('cream'),
      ),
    // UI要素
    'ui': (
        'placeholder': rgba(get-color-palette('off-white'), 0.5),
        'highlight': get-color-palette('yellow'),
        'focus-outline': get-color-palette('yellow'),
        'hover': get-color-palette('yellow'),
      ),
    'selection': (
      'selection-text': get-color-palette('dark-brown'),
      'selection-bg': get-color-palette('yellow'),
    ),
  ),
) !default;

// モード選択用変数(mod()で使用する)
$color_mode_dark: 'dark';

// ※$colorsを使用する場合
// get-color① CSS変数を返す function
// _color-theme.scss(generate-color-themes())で生成したCSS変数を取得
// @param $group カラーグループ名（text, bg, blue など）
// @param $name カラー名（primary, secondary など）
// @return CSS変数参照
//  例) get-color('text', 'primary') → var(--color-text-primary)
//  例) get-color('bg', 'base') → var(--color-bg-base)
@function get-color($_group, $_name) {
  @return var(--color-#{$_group}-#{$_name});
}

// ※$color-paletteを直接使用する場合
// get-color② CSS変数を返す function
// @param $name カラー名（primary, secondary など）
// @return $color-paletteの色
//  例) get-color('black')
// @function get-color($_key) {
//   $_value: get-color-palette($_key);

//   @if $_value == null {
//     @error "Color key '#{$_key}' not found in $color-palette.";
//   }

//   @return $_value;
// }

/* font
----------------------------------------------------------------- */
// フォントファイルのベースパス
$font-path-base: '../../assets/fonts/';

// フォント設定マップ(フォントファイルを用意した上で設定 => font-face設定)
// CDNを使用する場合は、フラット変数のみで運用
// 各フォントファミリーの設定を定義
// key名：フォントファミリー名(小文字 スペースは「-」つなぎ)
// 'family': フォントファミリー名（CSSで使用する名前）
// 'files': フォントファイルの設定配列
//   - 'file': ファイル名（$font-path-baseからの相対パス）
//   - 'weight': フォントウェイト（数値または範囲文字列 '100 900'）
//   - 'style': フォントスタイル（'normal' | 'italic'、デフォルト: 'normal'）
//   - 'variable': 可変フォントかどうか（true | false、デフォルト: false）
//   - 'variable-axes': 可変フォントの軸（'wght' | 'wght opsz' など、variable: trueの場合のみ）
$font-configs: (
  'noto-sans-jp': (
    'family': 'Noto Sans JP',
    'fallback': sans-serif,
    'files': (
      (
        'file': 'NotoSansJP-VariableFont_wght.woff2',
        'weight': '100 900',
        'style': 'normal',
        'variable': true,
        'variable-axes': 'wght',
      ),
    ),
  ),
  'inter': (
    'family': 'Inter',
    'fallback': sans-serif,
    'files': (
      (
        'file': 'Inter-VariableFont_opsz,wght.woff2',
        'weight': '100 900',
        'style': 'normal',
        'variable': true,
        'variable-axes': 'wght opsz',
      ),
    ),
  ),
  'mplus1p': (
    'family': 'M PLUS 1p',
    'fallback': sans-serif,
    'files': (
      (
        'file': 'MPLUS1p-Regular.woff2',
        'weight': 400,
        'style': 'normal',
        'variable': false,
      ),
      (
        'file': 'MPLUS1p-Medium.woff2',
        'weight': 500,
        'style': 'normal',
        'variable': false,
      ),
      (
        'file': 'MPLUS1p-Bold.woff2',
        'weight': 700,
        'style': 'normal',
        'variable': false,
      ),
      (
        'file': 'MPLUS1p-Black.woff2',
        'weight': 900,
        'style': 'normal',
        'variable': false,
      ),
    ),
  ),
  'rocknroll-one': (
    'family': 'RocknRoll One',
    'fallback': sans-serif,
    'files': (
      (
        'file': 'RocknRollOne-Regular.woff2',
        'weight': 400,
        'style': 'normal',
        'variable': false,
      ),
    ),
  ),
  'sahitya': (
    'family': 'Sahitya',
    'fallback': serif,
    'files': (
      (
        'file': 'Sahitya-Regular.woff2',
        'weight': 400,
        'style': 'normal',
        'variable': false,
      ),
      (
        'file': 'Sahitya-Bold.woff2',
        'weight': 700,
        'style': 'normal',
        'variable': false,
      ),
    ),
  ),
) !default;

// get-font-family-name フォントファミリー名を取得する
// @param $font-key フォントキー名（$font-configsのキー）
// @return フォントファミリー名（文字列）
//  例) get-font-family('noto-sans-jp') → 'Noto Sans JP'
@function get-font-family-name($_font-key) {
  $_config: map.get($font-configs, $_font-key);

  @if $_config ==null {
    @error "Font key '#{$_font-key}' not found in $font-configs.";
  }

  @return map.get($_config, 'family');
}

// get-font-fallback フォールバックフォントを取得する
// @param $font-key フォントキー名（$font-configsのキー）
// @return フォールバックフォント（sans-serif | serif | monospace など）
//  例) get-font-fallback('noto-sans-jp') → sans-serif
@function get-font-fallback($_font-key) {
  $_config: map.get($font-configs, $_font-key);

  @if $_config ==null {
    @error "Font key '#{$_font-key}' not found in $font-configs.";
  }

  @return map.get($_config, 'fallback');
}

// フォントファミリー一覧マップ（一元管理）
// 構造: $font-families: (key: (family, fallback))
// 実装の際は get-font-family() を使用して値を取得
$font-families: (
  'notosans': (
    get-font-family-name('noto-sans-jp'),
    get-font-fallback('noto-sans-jp'),
  ),
  'inter': (
    get-font-family-name('inter'),
    get-font-fallback('inter'),
  ),
  'mplus1p': (
    get-font-family-name('mplus1p'),
    get-font-fallback('mplus1p'),
  ),
  'rocknroll-one': (
    get-font-family-name('rocknroll-one'),
    get-font-fallback('rocknroll-one'),
  ),
  'sahitya': (
    get-font-family-name('sahitya'),
    get-font-fallback('sahitya'),
  ),
) !default;

// get-font-family フォントファミリー一覧から値を取得する
// @param $font-key フォントキー名（$font-familiesのキー）
// @return フォントファミリー名とフォールバックの組み合わせ
//  例) get-font-family('notosans') → 'Noto Sans JP', sans-serif
@function get-font-family($_font-key) {
  $_font-family: map.get($font-families, $_font-key);

  @if $_font-family ==null {
    @error "Font key '#{$_font-key}' not found in $font-families.";
  }

  @return $_font-family;
}

// フォントウェイト一覧マップ（一元管理）
// 構造: $font-weights: (key: value)
// 実装の際は get-font-weight() を使用して値を取得
$font-weights: (
  'thin': 100,
  'extralight': 200,
  'light': 300,
  'normal': 400,
  'medium': 500,
  'semibold': 600,
  'bold': 700,
  'extrabold': 800,
  'black': 900,
) !default;

// get-font-weight フォントウェイトの値を取得する
// @param $key フォントウェイトのキー名
// @return フォントウェイトの値（数値）
//  例) get-font-weight('bold') → 700
@function get-font-weight($_key) {
  $_value: map.get($font-weights, $_key);

  @if $_value ==null {
    @error "Font weight key '#{$_key}' not found in $font-weights.";
  }

  @return $_value;
}

/* image
----------------------------------------------------------------- */
// 画像パス一覧マップ（一元管理）
// 構造: $image-paths: (key: value)
// 実装の際は get-image-path() を使用して値を取得
$image-paths: (
  'webp': '../../assets/images/webp/',
  'avif': '../../assets/images/avif/',
  'compression': '../../assets/images/compression/',
  'svg': '../../assets/images/svg/',
) !default;

// get-image-path 画像パスの値を取得する
// @param $key 画像パスのキー名
// @return 画像パスの値（文字列）
//  例) get-image-path('webp') → '../../assets/images/webp/'
@function get-image-path($_key) {
  $_value: map.get($image-paths, $_key);

  @if $_value ==null {
    @error "Image path key '#{$_key}' not found in $image-paths.";
  }

  @return $_value;
}

/* height
----------------------------------------------------------------- */
// 高さ一覧マップ（一元管理）
// 構造: $heights: (key: value)
// 実装の際は get-height() を使用して値を取得
$heights: (
  'header-pc': 80,
  'header-sp': 80,
) !default;

// get-height 高さの値を取得する
// @param $key 高さのキー名
// @return 高さの値（数値）
//  例) get-height('header-pc') → 80
@function get-height($_key) {
  $_value: map.get($heights, $_key);

  @if $_value ==null {
    @error "Height key '#{$_key}' not found in $heights.";
  }

  @return $_value;
}

/* transition
----------------------------------------------------------------- */
// トランジション一覧マップ（一元管理）
// 構造: $transitions: (key: value)
// 実装の際は get-transition() を使用して値を取得
$transitions: (
  'normal': 0.3s,
  'fast': 0.2s,
) !default;

// get-transition トランジションの値を取得する
// @param $key トランジションのキー名
// @return トランジションの値（時間）
//  例) get-transition('normal') → 0.3s
@function get-transition($_key) {
  $_value: map.get($transitions, $_key);

  @if $_value ==null {
    @error "Transition key '#{$_key}' not found in $transitions.";
  }

  @return $_value;
}

/* border
----------------------------------------------------------------- */
// ボーダー一覧マップ（一元管理）
// 構造: $borders: (key: value)
// 実装の際は get-border() を使用して値を取得
$borders: (
  'normal': max(0.1rem, 1px) solid get-color('base', 'black'),
) !default;

// get-border ボーダーの値を取得する
// @param $key ボーダーのキー名
// @return ボーダーの値（文字列）
//  例) get-border('normal') → max(0.1rem, 1px) solid var(--color-base-black)
@function get-border($_key) {
  $_value: map.get($borders, $_key);

  @if $_value ==null {
    @error "Border key '#{$_key}' not found in $borders.";
  }

  @return $_value;
}

/* box-shadow
----------------------------------------------------------------- */
// ボックスシャドウ一覧マップ（一元管理）
// 構造: $box-shadows: (key: value)
// 実装の際は get-box-shadow() を使用して値を取得
$box-shadows: (
  'default': 0 0 1rem rgba(0, 0, 0, 0.3),
) !default;

// get-box-shadow ボックスシャドウの値を取得する
// @param $key ボックスシャドウのキー名
// @return ボックスシャドウの値（文字列）
//  例) get-box-shadow('default') → 0 0 1rem rgba(0, 0, 0, 0.3)
@function get-box-shadow($_key) {
  $_value: map.get($box-shadows, $_key);

  @if $_value ==null {
    @error "Box shadow key '#{$_key}' not found in $box-shadows.";
  }

  @return $_value;
}

/* z-index
----------------------------------------------------------------- */
// z-index一覧マップ（一元管理）
// 構造: $z-indexes: (key: value)
// 実装の際は get-z-index() を使用して値を取得
$z-indexes: (
  'base': 1,
  'header': 100,
  'modal': 1000,
  'tooltip': 2000,
) !default;

// get-z-index z-indexの値を取得する
// @param $key z-indexのキー名
// @return z-indexの値（数値）
//  例) get-z-index('header') → 100
@function get-z-index($_key) {
  $_value: map.get($z-indexes, $_key);

  @if $_value ==null {
    @error "Z-index key '#{$_key}' not found in $z-indexes.";
  }

  @return $_value;
}
